## Context
- Autodiff 接口因 Taichi 对 P2G/G2P 原子操作不支持而不可用，当前仅通过运行时异常/警告提示。
- 限制文档路径在代码中引用但存在缺失/不一致，用户无法获取限制说明。
- 能量 loss 仅计算动能，可能与“能量匹配”预期不符。
- 本构更新存在双核分支历史，需避免未来漂移。

## Goals / Non-Goals
- Goals: 明确并强制 Autodiff 不可用的保护策略；确保限制文档随代码可用且引用路径一致；澄清能量 loss 语义并在规格中要求一致；约束本构更新路径防止漂移。
- Non-Goals: 解决 Taichi AD 原子操作限制（需要框架/手动伴随）；性能优化。

## Decisions
- Autodiff 保护：在 API/CLI 层检测并短路梯度路径，返回明确错误/告警与可行替代方案，禁止 Tape 尝试运行 solver.step；在 README/限制文档中同步说明。
- 文档一致性：限制/实施状态文档必须存在于仓库中，并与代码引用路径一致（如有根目录文档需归位或说明）；缺失即阻断发布。
- Loss 语义：能量类 loss 默认定义为“动能”，需在接口/文档中显式声明；如用户需“总能量”，应提供 total_energy 选项或自定义指引，保持实现与说明一致。
- Kernel 路径：当前已用 ti.static 统一 STE/非 STE 分支，保持单路径；若未来出现分支，需同步测试覆盖和文档标注，防止未测试的漂移。

## Risks / Trade-offs
- 阻断梯度可能影响现有调用方预期，但可避免崩溃；需提供清晰替代路径。
- 增加文档检查可能阻塞发布，但提高可支持性。
- 统一 kernel 路径可能减少灵活性，但降低维护风险。

## Open Questions
- 能量 loss 是否应默认总能量（动能+弹性+粘性+投影）？建议默认“动能”并显式声明，同时提供 total_energy 选项供高级使用。
- 是否需要在 CLI 级别直接禁用 autodiff 相关入口？建议 API 层阻断即可，在 CLI 帮助中声明当前不可用，避免重复检查。
