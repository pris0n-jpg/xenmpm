"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"MPMFEMRGBFIX-000","P0","1","both","冻结复现基线与验收口径","固化 press-only/slide/debug 三组输出与验收口径，作为后续坐标/翻转修复的唯一证据源。","每组输出目录包含 run_manifest.json、metrics.json、metrics.csv；启用 --export-intermediate 时存在 intermediate/frame_0000.npz；total_frames>0 且 frame_to_phase 长度=total_frames；抽查 press/slide/hold 各≥1 帧 PNG 可读。","AUTOE2E","输出仅写入 --save-dir；manifest/run_context 可追溯生效参数（摩擦/marker/tint/翻转/record_interval/压头配置）；不引入硬编码路径；不改变默认 demo 行为（除非显式开关）。","同一环境复跑两次输出结构一致；press-only 与 slide(3mm) 的 phase_ranges_frames 符合预期；如新增开关，resolved.conventions 记录并可 diff。","已完成","已完成","已完成","已提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:21;Report.md:251;example/mpm_fem_rgb_compare.py:2573;example/mpm_fem_rgb_compare.py:3015;output/rgb_compare/baseline/run_manifest.json:1","picked_reason:P0 先固化可复现的三组输出与校验命令，作为后续翻转修复的唯一证据源;started_at:2025-12-30T22:43:54+08:00;done_at:2025-12-30T22:49:54+08:00;evidence:generated save_dirs=output/rgb_compare/press_only|baseline_short|baseline_debug_short;test:python example/validate_rgb_compare_output.py --save-dir <dir> --require-alignment --require-indenter-overlay (OK x3);test:image_open:PIL open fem_0000.png (OK x3);risk:low"
"MPMFEMRGBFIX-010","P0","2","both","建立坐标/翻转链路对照表","梳理 MPM/FEM 的坐标正方向与翻转发生点，形成可审计对照表以避免重复翻转。","产出一份可版本化文档（Report.md 小节或单独 notes.md）：包含各坐标系正方向、mesh x_range/y_range、texcoords u/v 约定、所有 flip 开关/函数位置；明确指出当前链路潜在重复翻转点（≥3 处）与推荐“只翻一次”的目标归属层。","AUTOSERVER","所有结论必须引用具体代码位置（path:line）；与 run_manifest/Report.md 表达一致；不臆测未验证的方向结论。","后续收敛翻转完成后，对照表可解释新旧输出差异，并能与 manifest.resolved.conventions 字段一一对应。","已完成","已完成","已完成","已提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:25;example/mpm_fem_rgb_compare.py:1501;xengym/render/sensorScene.py:197;example/mpm_fem_rgb_compare.py:1671;example/mpm_fem_rgb_compare.py:1773","picked_reason:P0 先把翻转链路与坐标约定文档化，避免后续修复出现重复翻转;started_at:2025-12-30T22:28:01+08:00;done_at:2025-12-30T22:36:16+08:00;evidence:updated Report.md section 11 坐标系/翻转链路对照表;test:python quick_test.py (OK);risk:low doc-only"
"MPMFEMRGBFIX-020","P0","3","backend","定位多翻/少翻环节（overlay+intermediate 对齐）","通过 --mpm-show-indenter/--mpm-debug-overlay 与 intermediate 对齐验证，确定最终渲染与 field flip/no-flip 的对应关系。","在 debug 输出目录生成带 overlay 的帧；对至少 3 帧（建议 0075/0080/0085）给出 flip/no-flip 一致性判定证据（截图路径或数值对比结果）；结论写入 tuning_notes.md 或 Report.md。","AUTOE2E","诊断仅增加可开关的 debug 输出，不影响默认渲染；诊断流程可复跑且与某个 save-dir 绑定；避免引入重依赖。","在另一组 save-dir 复跑诊断能得到同方向判定；无 cv2 时不崩溃（可降级为 numpy/PIL）。","已完成","已完成","已完成","已提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:29;example/mpm_fem_rgb_compare.py:1802;example/mpm_fem_rgb_compare.py:1826;example/mpm_fem_rgb_compare.py:1689;output/rgb_compare/baseline/intermediate/frame_0085.npz:1","picked_reason:P0 先用离线脚本给出 flip/no-flip 定量证据，指导后续翻转收敛;started_at:2025-12-30T22:53:47+08:00;done_at:2025-12-30T23:05:48+08:00;evidence:script best_counts(flip)=3 on output/rgb_compare/baseline frames=75,80,85;test:python example/analyze_rgb_compare_flip_alignment.py --save-dir output/rgb_compare/baseline --frames 75,80,85;test:python quick_test.py (OK);risk:low"
"MPMFEMRGBFIX-030","P0","4","backend","收敛 X 翻转为单一约定","选择唯一翻转归属层（field 或 mesh/texcoords），移除/开关化重复翻转来源，使 FEM/MPM 同帧同侧对齐。","press-only 与 slide 输出中，FEM/MPM 接触圈在同一侧（不互为镜像）；run_manifest.json.resolved.conventions 可审计记录最终翻转约定；若默认行为变化，提供兼容开关或迁移说明。","AUTOE2E","改动范围仅限翻转/坐标约定对齐；不做无关重构；关键开关默认值变更需明确说明并写入 manifest；保持 quick_test.py 通过。","复跑 baseline_debug 与 baseline 对比：镜像问题消失；如启用兼容开关，旧输出可复现；metrics 行数与 total_frames 保持一致且 Import-Csv 可解析。","未开始","未开始","未开始","未提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:33;example/mpm_fem_rgb_compare.py:1565;example/mpm_fem_rgb_compare.py:1780;example/mpm_fem_rgb_compare.py:1676;xengym/render/sensorScene.py:197;Report.md:251",""
"MPMFEMRGBFIX-040","P1","5","backend","校验 marker warp 的方向/尺度/边界","确保 warp 位移方向与 slide 一致、mm→px 量级合理、边界无拉丝伪影（cv2/numpy 行为一致）。","slide/hold 后段 debug overlay(warp) 显示位移主要集中于接触区且方向与 FEM 一致；uv_disp_mm→dx_px 的 p90/max 量级合理且无大面积 clip；边缘 marker 不出现持续拉丝/断裂。","AUTOE2E","mm→px 换算仅使用 gel_size_mm 与纹理分辨率；cv2.remap 前必须 clip；不引入新依赖；warp flip 的约定需与翻转收敛方案一致。","无 cv2 环境下 numpy fallback 行为一致；不同 record_interval 下 warp 稳定；press-only(slide=0) 下 warp 近似静止。","未开始","未开始","未开始","未提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:37;example/mpm_fem_rgb_compare.py:460;example/mpm_fem_rgb_compare.py:518;example/mpm_fem_rgb_compare.py:1671;example/mpm_fem_rgb_compare.py:1810",""
"MPMFEMRGBFIX-050","P1","6","backend","收敛高度场离群值（与方向问题解耦）","在坐标对齐后，按 clamp→fill/smooth→clip_outliers 顺序收敛 height_field 异常深值，降低 halo/dark blob 与 UV 绑定污染。","抽样帧（≥9 帧覆盖 press/slide/hold）中 height_field_mm 极端负值比例显著下降；启用 clip_outliers 时 outliers 置为 NaN 且 fill_holes 可补齐；halo/dark blob 明显收敛（提供截图路径或对比指标）。","AUTOE2E","开关可回退且默认不静默改变旧行为；NaN/inf/空洞处理稳健；处理开销不出现数量级上升。","python quick_test.py 通过；关闭所有收敛开关时仍能生成输出；开启收敛开关时 metrics 可写出且 Import-Csv 可解析。","未开始","未开始","未开始","未提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:42;example/mpm_fem_rgb_compare.py:1078;example/mpm_fem_rgb_compare.py:1278;example/mpm_fem_rgb_compare.py:2963;example/mpm_fem_rgb_compare.py:2971",""
"MPMFEMRGBFIX-060","P2","7","both","完善启动/默认行为指南（marker+interactive）","明确 marker 默认值、headless/interactive 启动规则，并提供 baseline/debug/press-only 三条推荐命令。","文档包含：--mpm-marker 默认值、--save-dir 默认 headless、--interactive 启动 UI；给出 3 条可直接复制运行的命令；文档内容与 argparse/manifest 一致。","AUTOSERVER","所有命令参数与脚本 argparse 一致；不写过期默认值；路径使用仓库相对路径；避免把临时 output 目录写死。","按文档命令运行可生成完整输出结构（run_manifest/metrics/intermediate）；无依赖环境至少能生成 preflight manifest。","未开始","未开始","未开始","未提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:46;Report.md:251;example/mpm_fem_rgb_compare.py:2955;example/mpm_fem_rgb_compare.py:3015;example/mpm_fem_rgb_compare.py:3386",""
"MPMFEMRGBFIX-070","P1","8","backend","增加镜像回归离线哨兵测试","在无 taichi/ezgl 环境下，通过读取 intermediate 与输出帧计算差分质心/镜像偏差，防止 X 翻转回归。","新增/增强测试可在纯 numpy/PIL 环境运行；镜像偏差超过阈值时稳定失败并输出明确提示（指向 flip 开关/约定）；运行时间<10s 且不写入大文件。","AUTOSERVER","测试不依赖 taichi/ezgl；不要求像素级完全相等（避免脆弱）；阈值/算法说明写入测试注释或文档。","python quick_test.py 通过；在已有 baseline 目录可复跑并输出统计；无 baseline 时可跳过或给出可读提示（不误报）。","未开始","未开始","未开始","未提交","","plan/2025-12-30_21-45-38-mpm-fem-rgb-baseline-fix.md:50;quick_test.py:221;example/mpm_fem_rgb_compare.py:2458;output/rgb_compare/baseline/intermediate/frame_0075.npz:1;Report.md:251",""
