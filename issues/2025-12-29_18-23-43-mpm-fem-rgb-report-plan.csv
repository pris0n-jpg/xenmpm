"id","priority","phase","area","title","description","acceptance_criteria","test_mcp","review_initial_requirements","review_regression_requirements","dev_state","review_initial_state","review_regression_state","git_state","owner","refs","notes"
"MPMFEMRGBPLAN-000","P0","1","both","固化基线运行与输出产物","在具备 taichi/ezgl 的可运行环境执行推荐基线命令，产出可审计帧序列、run_manifest、metrics 与 intermediate，作为后续对齐与伪影定位的唯一证据源。","基线命令在 --save-dir 下生成 run_manifest.json、metrics.csv、metrics.json；开启 --export-intermediate 时生成 intermediate/frame_0000.npz；连续运行 2 次 total_frames 与 frame_to_phase 映射一致；Import-Csv 可解析 metrics.csv 且行数等于 total_frames。","AUTOE2E","输出只写入 --save-dir；启动日志与 manifest 回显生效参数（摩擦/marker/tint/heightfield 开关/record_interval/压头配置）；不修改默认 demo 行为。","同一环境复跑基线命令两次，确认输出结构稳定、manifest 可 diff；抽查 press/slide/hold 各 1 帧 PNG 可读。","已完成","已完成","已完成","已提交","","plan/2025-12-29_18-08-17-mpm-fem-rgb-report-plan.md:21;example/mpm_fem_rgb_compare.py:3143;example/mpm_fem_rgb_compare.py:591;quick_test.py:193;example/validate_rgb_compare_output.py:1","picked_reason:P0 先固化 baseline 输出校验脚本 + 复跑一致性证据，作为后续对齐/伪影收敛的共同基准;started_at:2025-12-29T19:24:20+08:00;done_at:2025-12-29T19:29:51+08:00;evidence:baseline_run1=output/rgb_compare/_baseline_run1_2025-12-29_19-26-01; baseline_run2=output/rgb_compare/_baseline_run2_2025-12-29_19-27-13; total_frames=86; frame_to_phase_equal=true; Import-Csv(metrics.csv) rows=86;test:python example/validate_rgb_compare_output.py --save-dir <dir>"
"MPMFEMRGBPLAN-010","P0","2","both","对齐摩擦/尺度/压头接触面并记录","完成 FEM/MPM 对比前的关键基线对齐，避免将摩擦/尺度/压头接触面差异误判为 MPM bug。","启动日志或 manifest 显示 friction.aligned=true；Scale consistent=true；FEM 侧明确 fem_indenter_face 与 contact_face_key，MPM 侧明确 indenter_type；至少保存 1 帧带 --mpm-show-indenter 的 overlay 作为对齐证据；若不一致，给出修正参数并复跑生成新的 save-dir。","AUTOE2E","对齐项必须可追溯（写入 manifest/run_context）；所有修正通过 CLI 开关完成，避免硬编码静默修改。","同一命令复跑后对齐项回显稳定；抽查 overlay 帧中压头投影方向/尺度不反且与 FEM 接触轮廓可比。","未开始","未开始","未开始","未提交","","plan/2025-12-29_18-08-17-mpm-fem-rgb-report-plan.md:27;example/mpm_fem_rgb_compare.py:2932;example/mpm_fem_rgb_compare.py:2948;example/mpm_fem_rgb_compare.py:2666;example/mpm_fem_rgb_compare.py:2785;example/mpm_fem_rgb_compare.py:3082",""
"MPMFEMRGBPLAN-020","P1","3","both","伪影分型与证据抽样（基于 intermediate）","从 press/slide/hold 抽样帧统计 height_field_mm 与 uv_disp_mm 分布并标注 dark blob/halo/边缘拉丝，形成可复现的归因表。","输出一份可版本化表格（analysis.csv 或 analysis_notes.md）覆盖≥9帧：frame_id、phase、height_field min/p1/p99、uv_disp p99、现象标签；指标可由 intermediate/frame_*.npz 重新计算并一致。","AUTOE2E","分析流程仅依赖 numpy（无 ezgl/taichi 也可复跑）；阈值/规则写入文档并与具体输出目录绑定。","在另一组 save-dir 上复跑分析不崩溃且输出字段一致；抽查 3 帧与 npz 内容可对齐复现。","未开始","未开始","未开始","未提交","","plan/2025-12-29_18-08-17-mpm-fem-rgb-report-plan.md:35;example/mpm_fem_rgb_compare.py:2809;example/mpm_fem_rgb_compare.py:2261;quick_test.py:91",""
"MPMFEMRGBPLAN-030","P0","4","both","高度场伪影收敛（clamp→fill/smooth→离群处理开关化）","抑制 MPM 高度场异常深值导致的暗盘与 halo：优先验证 clamp_indenter，再迭代 fill_holes/smooth 参数；必要时为 footprint 外离群值处理新增可回退开关。","在抽样帧上 dark blob 明显减少（可用 ROI 像素或 metrics p99 下降作为指标）；clamp/fill/smooth 通过 CLI 可开关并写入 manifest；新增离群处理不静默改变默认（默认 off 或保持现有基线行为）。","AUTOE2E","数值处理稳健（NaN/inf/空洞）；不引入重依赖；每帧处理开销不出现数量级上升；所有行为可回退。","对比 clamp on/off 与 fill/smooth 不同 iters 的输出变化符合预期且可解释；python quick_test.py 通过；无依赖环境仍能生成 manifest。","未开始","未开始","未开始","未提交","","plan/2025-12-29_18-08-17-mpm-fem-rgb-report-plan.md:42;example/mpm_fem_rgb_compare.py:1078;example/mpm_fem_rgb_compare.py:1132;example/mpm_fem_rgb_compare.py:1584;example/mpm_fem_rgb_compare.py:2760;example/mpm_fem_rgb_compare.py:3101",""
"MPMFEMRGBPLAN-040","P0","5","both","marker warp 方向与边缘伪影收敛（翻转去重 + remap 边界一致性）","确保 mpm-marker=warp 的位移方向与滑移轨迹一致，避免多处 flip 叠加；将 cv2 remap 出界行为与 numpy fallback 对齐以消除边缘拉丝干扰。","在 --mpm-debug-overlay uv|warp 下，slide phase 接触 ROI 的方向与轨迹一致；manifest 明确记录 flip 组合且同一轴不被重复修正；cv2 环境下边缘不再出现由出界反射导致的拉丝（边界策略与 numpy clip 一致或提供可回退开关）。","AUTOE2E","翻转与边界策略变更必须可配置并回显到 manifest；不静默改变旧默认；cv2 不可用时仍有 numpy fallback。","分别在有/无 cv2 环境下运行 warp 不崩溃且方向一致；导出 intermediate 验证 uv_disp 分布合理。","已完成","已完成","已完成","已提交","","plan/2025-12-29_18-08-17-mpm-fem-rgb-report-plan.md:50;example/mpm_fem_rgb_compare.py:460;example/mpm_fem_rgb_compare.py:523;example/mpm_fem_rgb_compare.py:1481;example/mpm_fem_rgb_compare.py:1371;example/mpm_fem_rgb_compare.py:552","picked_reason:P0 修复 marker warp 翻转/边界一致性，减少方向怪与边缘拉丝，便于后续高度场/对齐归因;started_at:2025-12-29T19:11:07+08:00;done_at:2025-12-29T19:21:09+08:00;evidence:quick_test OK; e2e_smoke:output/rgb_compare/_smoke_warp_fix_2025-12-29_19-18-16 (30 frames + metrics + intermediate);changes:clip cv2.remap map; remove u-negate (avoid double flip)"
"MPMFEMRGBPLAN-050","P1","6.1","both","审计落盘：manifest 字段与调参记录稳定化","将对齐项、渲染/高度场/marker 关键开关与调参结果固化到 run_manifest.json 与输出目录文档，形成可 diff 的证据链。","save-dir 内 run_manifest.json 含 run_context.resolved（至少 friction/scale/conventions/render/export）；存在 tuning_notes.md（或等价）记录基线命令、关键帧号、参数与结论；同机同命令连续运行 2 次除时间戳外关键字段一致。","AUTOE2E","manifest 字段命名稳定且向后兼容；输出只写入 save-dir；不写入敏感路径/环境信息（除 argv）。","对两个 run_manifest.json 做 diff，除 created_at/argv 外一致；Import-Csv 解析 metrics 不受影响。","未开始","未开始","未开始","未提交","","plan/2025-12-29_18-08-17-mpm-fem-rgb-report-plan.md:58;example/mpm_fem_rgb_compare.py:591;example/mpm_fem_rgb_compare.py:3082;quick_test.py:193",""
"MPMFEMRGBPLAN-060","P1","6.2","both","回归与文档：扩展 quick_test + 更新 Report.md","把对齐项/flip 约定/CLI surface 以无依赖 smoke test 固化，并在 Report.md 更新最终推荐基线与排查 checklist，便于后续协作执行。","python quick_test.py 在无 ezgl/taichi 环境通过并覆盖新增断言；Report.md 包含推荐基线命令、排查顺序、常见现象到开关与中间量的映射；所有新文件为 UTF-8（终端与 Excel 无乱码）。","AUTOSERVER","quick_test 不引入新重依赖、不依赖 GUI；文档强调可执行命令与验收口径；refs 指向具体代码行。","help 文本变化时同步更新断言；在 CI/本机多次运行 quick_test 稳定；回归确保旧 plan/issue 链接仍可跳转。","未开始","未开始","未开始","未提交","","plan/2025-12-29_18-08-17-mpm-fem-rgb-report-plan.md:58;quick_test.py:1;Report.md:1;example/mpm_fem_rgb_compare.py:2704",""
